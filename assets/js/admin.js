jQuery(function(i){wpas_admin_object.auth_token&&localStorage.setItem("wpas_import_ext_objects",JSON.stringify(wpas_admin_object));var c={ajax:function(a){return jQuery.post(wpas_admin_object.ajax_url,a)},preLoader:function(){return'<div class="wpas-ajax-pre-loader-container" ><img  class="wpas-ajax-pre-loader" src="'+wpas_admin_object.image_path+'pre-loader.gif" alt="Loadding..." /></div>'},loadMorePreLoader:function(){return'<img  class="wpas-ajax-loadmore-pre-loader" src="'+wpas_admin_object.image_path+'load-more.gif" alt="Loadding..." />'},pagination:function(a,t){if(1<t)var e='<li class="acl-product-import-previous" data-val="'+parseInt(t-1)+'">Previous</li>';else e="";for(var o=[],r=1;r<=a;r++)o.push(r);var n=[];for(r=1;r<=5;r++){var s=c.closestValue(o,t);n.push(s);var p=o.indexOf(s);-1!==p&&o.splice(p,1)}1!=t&&n.push(parseInt(t)),(n=n.filter(function(a,t,e){return t===e.indexOf(a)})).sort();for(r=n[0];r<=n.length;r++)e+=t==r?'<li class="acl-pagination-item-active" data-val="'+r+'">'+r+"</li>":'<li data-val="'+r+'">'+r+"</li>";t<a&&(e+='<li class="acl-product-import-next" data-val="'+parseInt(parseInt(t)+1)+'">Next</li>');return e},closestValue:function(a,t){for(var e=0;a[++e]<t;);return a[--e]},queBox:function(a,t,e,o,r){return'<div class="acl-col-md-2">\n<div class="acl-product-box" >\n<div class="acl-product-box-remove" data-thumb="'+o+'" data-url="'+e+'" data-asin="'+a+'" data-price="'+r+'"></div>\n<div class="acl-product-box-thumb">\n<img src="'+o+'" alt="'+t+'">\n</div>\n<div class="acl-product-box-info">\n<h3>'+t+"</h3>\n</div>\n</div>\n</div>"}};function o(e,a){i(".wpas-import-products-container,#wpas-woo-categories-container").show(),i(".wpas-import-pre-loader-container").html(c.preLoader());var t=wpas_admin_object.store_country+"&Keywords="+e+"&SearchIndex="+a+"&multipageStart="+wpas_admin_object.page_number+"&multipageCount="+wpas_admin_object.prouct_per_page;i.ajax({url:t,dataType:"jsonp",jsonpCallback:"search_callback",success:function(a){var t={action:"wpas_products_import_search",keyword:e,data:a.results};c.ajax(t).done(function(a){i(".wpas-import-pre-loader-container").html(""),i(".wpas-import-products-list").html(a.html),a.product_num>=wpas_admin_object.prouct_per_page?(i(".wpas-load-more-wrapper").show(),i("#wpas-import-load-more-btn").attr("data-keyword",a.keyword),i("#wpas-import-load-more-btn").attr("data-page-num",a.page_num)):i(".wpas-load-more-wrapper").hide()})},error:function(a,t,e){console.log(a,t,e)}})}function s(t,a,e){if(i(".wpas-no-aws-import-products-row").html(c.preLoader()),i("#backTop").show(),sessionStorage.getItem("wpasImport")){var o=JSON.parse(sessionStorage.getItem("wpasImport")).filter(function(a){return a.key==t});if(0<o.length){i(".wpas-no-aws-import-products-row").html(c.preLoader());var r=o[0],n=decodeURIComponent(escape(atob(r.value)));"search"==e?i(".acl-pagination-section").show():i(".acl-pagination-section").hide(),i(".wpas-no-pa-add-all-container").show(),i(".acl-product-import-pagination").html(c.pagination(20,a)),i(".wpas-no-aws-import-products-row").html(n),i("#wpas-search-string").val(t)}else{var s=encodeURI(wpas_admin_object.store_url+t),p={type:"search",search_string:t,page:a,search_url:s};window.postMessage(p,"*")}}else{s=encodeURI(wpas_admin_object.store_url+t),p={type:"search",search_string:t,page:a,search_url:s};window.postMessage(p,"*")}}function e(a){i(".wpas-no-aws-import-products-queue-section").show(),i(".wpas-no-aws-import-products-log-section").hide();var t=a.attr("data-asin"),e=a.attr("data-title"),o=a.attr("data-url"),r=a.attr("data-thumb"),n=a.attr("data-price"),s=c.queBox(t,e,o,r,n);i("#wpas-no-pa-queue-box-container").append(s),a.text("Added to Queue"),a.attr("disabled",!0),a.parent().parent().addClass("acl-product-added-box"),p(),i("body").animate({scrollTop:i(document).height()},1e3)}function t(a){var t=a.attr("data-asin");0<i("#wpas-import-"+t).length&&(i("#wpas-import-"+t).removeClass("acl-product-added-box"),i("#wpas-import-"+t).find("button").attr("disabled",!1)),a.parent().parent().remove(),p()}function p(){i("#import-selected-products").text(i(".acl-product-box-remove").length),0==i(".acl-product-box-remove").length&&i(".wpas-no-aws-import-products-queue-section").hide()}function r(t){if("search"==i("input[name='no_pa_import_by']:checked").val())if(sessionStorage.getItem("wpasImport")){if(0<(o=JSON.parse(sessionStorage.getItem("wpasImport"))).filter(function(a){return a.key==t}).length){var a=o.filter(function(a){return a.key!=t}),e={key:t,value:btoa(unescape(encodeURIComponent(i(".wpas-no-aws-import-products-row").html())))};a.push(e),sessionStorage.setItem("wpasImport",JSON.stringify(a))}else{e={key:t,value:btoa(unescape(encodeURIComponent(i(".wpas-no-aws-import-products-row").html())))};o.push(e),sessionStorage.setItem("wpasImport",JSON.stringify(o))}}else{var o=[];e={key:t,value:btoa(unescape(encodeURIComponent(i(".wpas-no-aws-import-products-row").html())))};o.push(e),sessionStorage.setItem("wpasImport",JSON.stringify(o))}}i(".wpas-import-products-container,#wpas-woo-categories-container").hide(),i("#wpas_import_search_keywords").on("keypress",function(a){if(13==a.which||13==a.keyCode){a.preventDefault();var t=i(this).val().trim(),e=i("#wpas_import_search_category").val();""!=t?o(t,e):(i("#wpas-import-validation-msg").show(),setTimeout(function(){i("#wpas-import-validation-msg").hide()},2e3))}}),i("#wpas_import_search_btn").on("click",function(a){a.preventDefault();var t=i("#wpas_import_search_keywords").val().trim(),e=i("#wpas_import_search_category").val();""!=t?o(t,e):(i("#wpas-import-validation-msg").show(),setTimeout(function(){i("#wpas-import-validation-msg").hide()},2e3))}),i(document).on("click","#wpas-import-load-more-btn",function(){var e=i(this).attr("data-keyword"),o=i(this).attr("data-page-num");if(1==o)var a=20;else if(2==o)a=20;var t=i("#wpas_import_search_category").val();i(".wpas-import-pre-loader-container").html(c.preLoader());var r=wpas_admin_object.store_country+"&Keywords="+e+"&SearchIndex="+t+"&multipageStart="+o+"&multipageCount="+a;i.ajax({url:r,dataType:"jsonp",jsonpCallback:"search_callback",success:function(a){var t={action:"wpas_products_import_search",keyword:e,data:a.results,page_num:o};c.ajax(t).done(function(a){i(".wpas-import-pre-loader-container").html(""),i(".wpas-import-products-list").html(a.html),a.product_num<20?(i(".wpas-load-more-wrapper").show(),i("#wpas-import-load-more-btn").attr("data-keyword",a.keyword),i("#wpas-import-load-more-btn").attr("data-page-num",a.page_num)):i(".wpas-load-more-wrapper").hide()})},error:function(a,t,e){console.log(a,t,e)}})}),i(document).on("click",".wpas-item-import-btn",function(a){a.preventDefault();var t=i(this);t.text("Importing...");var e=JSON.parse(atob(i(this).attr("wpas-import-data"))),o=i("#wpas_woo_category").val(),r={action:"wpas_import_product_from_amazon",sku:e.ASIN,title:e.Title,price:e.Price,amazon_url:e.DetailPageURL,image:e.ImageUrl,importing_category:o};jQuery.post(wpas_admin_object.ajax_url,r,function(a){200==a.status?t.text(a.message):t.text(a.message).css({"word-wrap":"break-word",display:"inline"}),t.parent().find(".wpas-import-success-action").html(a.success_action)})}),jQuery(document).on("ready",function(){if(0<i("#auth-token-generator").length||0<i("#wpas_no_pa_import_submit").length){var t;0<i("#auth-token-generator").length?t=i("#auth-token-generator"):0<i("#wpas_no_pa_import_submit").length&&(t=i("#wpas_no_pa_import_submit"));try{i.get("chrome-extension://chlnealbecgihlcianbcpdjjbabhdgnm/images/icons/icon_16.png").done(function(a){console.log("Wp Amazon shop Ext is installed")}).fail(function(a){t.attr("disabled","disabled"),t.parent().append('<a id="wpas-ext-install-notice" style="color:red;" class="button button-secondary" target="_blank" href="https://amadercode.com/product-import-docs/">Follow the <strong>Product Importing Guidelinse</strong></a>'),console.log("Wp Amazon shop Ext is not installed")})}catch(a){console.log("Wp Amazon shop Ext is not installed")}}0<i(".wpas-upgrade-link-text").length&&i(".wpas-upgrade-link-text").parent().attr("target","_blank"),i('select[name="acl_wpas_use_for"],input[name="acl_wpas_product_display_option[]"],input[name="acl_wpas_buy_now_action"],input[name="acl_wpas_enable_no_follow"],select[name="acl_wpas_cart_import_category"]').prop("disabled",!0)}),i(".acl-pagination-section,.wpas-no-pa-add-all-container,.wpas-no-aws-import-products-queue-section,.wpas-no-aws-import-products-log-section").hide(),i(".wpas_no_pa_import_by").on("change",function(a){"search"==i(this).val()?(i("#wpas_no_pa_cat").parent().show(),i("#wpas_no_pa_sort").parent().show(),i("#wpas_no_pa_import_submit").prop("disabled",!1),i("#wpas_no_pa_keyword").val("").attr("placeholder","Type search keyword")):(i("#wpas_no_pa_cat").parent().hide(),i("#wpas_no_pa_sort").parent().hide(),i("#wpas_no_pa_import_submit").prop("disabled",!0),i("#wpas_no_pa_keyword").val("").attr("placeholder","ASIN Numbers to Import Products(Comma Separated)"))}),i(document).on("click","#wpas_no_pa_import_submit",function(a){a.preventDefault();var t=i("input[name=no_pa_import_by]:checked").val(),e=i("#wpas_no_pa_keyword").val();if(""!=e){if("search"==t){var o=i("#wpas_no_pa_cat").val(),r=i("#wpas_no_pa_sort").val();if("all"!=r)var n="s?k="+e.replace(/\s/g,"+")+"&i="+o+"&s="+r+"&page=1";else n="s?k="+e.replace(/\s/g,"+")+"&i="+o+"&page=1";s(n,1,"search")}}else alert("Type keywords")}),i("#wpas_no_pa_keyword").on("keypress",function(a){if(13==a.which||13==a.keyCode){var t=i("#wpas_no_pa_keyword").val(),e=i("input[name=no_pa_import_by]:checked").val();if(""!=t){if("search"==e){var o=i("#wpas_no_pa_cat").val(),r=i("#wpas_no_pa_sort").val();if("all"!=r)var n="s?k="+t.replace(/\s/g,"+")+"&i="+o+"&s="+r+"&page=1";else n="s?k="+t.replace(/\s/g,"+")+"&i="+o+"&page=1";s(n,1,"search")}}else alert("Type keywords")}}),i(document).on("click",".acl-product-import-pagination li",function(a){i("html, body").animate({scrollTop:0},2e3);var t=i(this).attr("data-val"),e=i("#wpas_no_pa_cat").val(),o=i("#wpas_no_pa_sort").val(),r=i("#wpas_no_pa_keyword").val();if("all"!=o)var n="s?k="+r.replace(" ","+")+"&i="+e+"&s="+o+"&page="+t;else n="s?k="+r.replace(" ","+")+"&i="+e+"&page="+t;s(n,t,"search")}),i(document).on("click",".acl-product-box-action button",function(a){a.preventDefault();var t=i(this);if(!(i(".acl-product-box-remove").length<=20))return alert("Mximum 20 product can import at a time, Upgrade to Pro for UNLIMITED"),!1;e(t),r(i("#wpas-search-string").val())}),i(document).on("change","#wpas_add_all_to_queue",function(a){i(".acl-product-box-action").length>i(".acl-product-added-box").length?i(this).is(":checked")&&confirm("Are you sure to add all products to import list.?")&&(i(".acl-product-box-action button").each(function(a){var t=i(this);if(!(i(".acl-product-box-remove").length<=20))return alert("Mximum 20 product can import at a time, Upgrade to Pro for UNLIMITED"),!1;e(t),setTimeout(function(){r(i("#wpas-search-string").val())},1500)}),setTimeout(function(a){i("#wpas_add_all_to_queue").prop("checked",!1)},1e3)):(alert("All products are added to import queue."),i(this).prop("checked",!1))}),i(document).on("click",".acl-product-box-remove",function(a){a.preventDefault(),confirm("Are you sure to remove this product from import list.?")&&(t(i(this)),r(i("#wpas-search-string").val()))}),i(document).on("change","#wpas_remove_all_from_queue",function(a){i(this).is(":checked")&&(0<i(".acl-product-box-remove").length?confirm("Are you sure to remove all products from queue list.?")&&(i(".acl-product-box-remove").each(function(a){t(i(this)),setTimeout(function(){r(i("#wpas-search-string").val())},1500)}),setTimeout(function(a){i("#wpas_remove_all_from_queue").prop("checked",!1)},1e3)):(alert("No products, add product to queue."),i(this).prop("checked",!1)))}),i(document).on("click","#auth-token-generator",function(a){a.preventDefault();for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=e.length,r=0;r<39;r++)t+=e.charAt(Math.floor(Math.random()*o));i("#auth_token").val(t)}),i(document).on("click","#wpas-ext-auth-form-submit-btn",function(a){var t="",e=i("#auth_token").val();if(""==e&&(t+="Authentication Token is required"),""==t){var o={action:"wpas_chrome_ext_auth",auth_token:e};c.ajax(o).done(function(a){console.log(a),200==a.status?(i("#wpbody-content").prepend(a.message),setTimeout(function(){window.location.href=a.redirect_url},1e3)):alert("Try again!")})}else alert(t)})});